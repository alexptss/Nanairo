/*!
  \file NRussianRouletteSettingBlock.qml
  \author Sho Ikeda

  Copyright (c) 2015-2016 Sho Ikeda
  This software is released under the MIT License.
  http://opensource.org/licenses/mit-license.php
  */

import QtQuick @qt_quick_version@
import QtQuick.Controls @qt_quick_controls_version@
import "../SettingBlockItems"

NSettingBlock {
  id: russian_roulette_setting_block 

  readonly property int defaultPathLength: 3

  labelText: qsTr("RussianRoulette")

  NComboBox {
    id: russian_roulette_combobox

    y: russian_roulette_setting_block.labelHeight + @item_offset@
    backgroundColor: russian_roulette_setting_block.color

    model: ["@rouletteMaxReflectance@",
            "@rouletteAverageReflectance@",
            "@roulettePathLength@"]

    onCurrentIndexChanged: {
      path_length_spinbox.value = defaultPathLength;
    }
  }

  NIntSpinBox {
    id: path_length_spinbox

    y: (russian_roulette_combobox.y + russian_roulette_combobox.height) + @item_offset@
    enabled: russian_roulette_combobox.currentText == "@roulettePathLength@"

    maximumValue: 99
    minimumValue: 1
    suffix: " " + qsTr("path")
  }

  function getSceneData() {
    var sceneData = {};
    sceneData["@russianRoulette@"] = russian_roulette_combobox.currentText;
    sceneData["@pathLength@"] = path_length_spinbox.value;
    return sceneData;
  }

  function setSceneData(sceneData) {
    russian_roulette_combobox.currentIndex =
        russian_roulette_combobox.find(sceneData["@russianRoulette@"]);
    path_length_spinbox.value = sceneData["@pathLength@"];
  }
}
