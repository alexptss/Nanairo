/*!
  \file NImageResolutionSettingBlock.qml
  \author Sho Ikeda

  Copyright (c) 2015-2016 Sho Ikeda
  This software is released under the MIT License.
  http://opensource.org/licenses/mit-license.php
  */

import QtQuick @qt_quick_version@
import QtQuick.Controls @qt_quick_controls_version@
import "../../SettingBlockItems"

NSettingBlock {
  id: checkerboard_resolution_setting_block

  property var currentItem: null
  property bool isItemChangeMode: false

  labelText: qsTr("CheckerboardResolution")

  NIntSpinBox {
    id: width_resolution_spinbox

    anchors.horizontalCenter: undefined
    x: cross_label.x - (width + 5)
    y: checkerboard_resolution_setting_block.labelHeight + @item_offset@
    width: 60
    height: 20

    maximumValue: @integer32_max@
    minimumValue: 1

    onValueChanged: {
      setCurrentItemValue("@imageResolution@x", value);
    }
  }

  Label {
    id: cross_label

    anchors.horizontalCenter: checkerboard_resolution_setting_block.horizontalCenter
    y: width_resolution_spinbox.y

    text: qsTr("x")
    textFormat: Text.PlainText
    verticalAlignment: Text.AlignVCenter
    horizontalAlignment: Text.AlignHCenter
  }

  NIntSpinBox {
    id: height_resolution_spinbox

    anchors.horizontalCenter: undefined
    x: cross_label.x + cross_label.width + 5
    y: cross_label.y
    width: 60
    height: 20

    maximumValue: @integer32_max@
    minimumValue: 1

    onValueChanged: {
      setCurrentItemValue("@imageResolution@y", value);
    }
  }

  function initializeItem(item) {
    item["@imageResolution@x"] = 10;
    item["@imageResolution@y"] = 10;
  }

  function reflectItem() {
    var item = currentItem;
    // Resolution
    var width = item["@imageResolution@x"];
    var height = item["@imageResolution@y"];
    width_resolution_spinbox.value = width;
    height_resolution_spinbox.value = height;
  }

  function setCurrentItem(item, itemChangeMode) {
    currentItem = item;
    isItemChangeMode = itemChangeMode;
  }

  function setCurrentItemValue(key, value) {
    if (currentItem != null) {
      currentItem[key] = value;
    }
  }

  function getItemData(item) {
    var itemData = {};
    var width = item["@imageResolution@x"];
    var height = item["@imageResolution@y"];
    itemData["@imageResolution@"] = [width, height];
    return itemData;
  }

  function makeItem(itemData) {
    var item = {};
    var resolution = itemData["@imageResolution@"];
    item["@imageResolution@x"] = resolution[0];
    item["@imageResolution@y"] = resolution[1];
    return item;
  }
}
